@using Agroin4.CustomHtmlHelpers
@model Agroin4.Models.article


@{
    ViewBag.Title = "Details";
}
<div class="card">
    @*<h2>Details</h2>*@

    <div class="header bg-light-green">
        <h2 class="col-light-green p-l-10 ">Article Details</h2>
    </div>
    @*<hr />*@
    <dl class="dl-horizontal p-t-10">

        @Html.HiddenFor(m => m.id, new { id = "hiddenIdField" })


        <dt>
            @Html.DisplayNameFor(model => model.article_name)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.article_name)
        </dd>

        @*<dt>
                @Html.DisplayNameFor(model => model.crop_id)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.crop_id)
            </dd>*@

        <dt>
            @Html.DisplayNameFor(model => model.date_time)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.date_time)
        </dd>

        @*<dt>
                @Html.DisplayNameFor(model => model.rating)
            </dt>

            <dd>
                @Html.DisplayFor(model => model.rating)
            </dd>*@

        <dt>
            @Html.DisplayNameFor(model => model.expert_email)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.expert_email)
        </dd>
        <hr>
        <dt>
            @Html.DisplayNameFor(model => model.article_description)
        </dt>
        @*<br />*@
        <dd>
            <div style="overflow:auto;word-wrap:hyphenate;text-align:justify; max-width:700px">
                @Html.DisplayWithBreaksFor(model => model.article_description)
            </div>

        </dd>

    </dl>
</div>

@*<div>
        @Html.Partial("/comments1/index",new ViewDataDictionary { { "id",Model.id } })
    </div>*@
@*<div>
        @Html.ActionLink("comment","comment",new {id=Model.id })
    </div>*@
<div class="card">
    <br />
    <p>
        <div class="input-group">
            <span class="input-group-addon">Comment here</span>
            <input type="text" id="txtComments" class="form-control " placeholder="text" aria-describedby="basic-addon1">
        </div>
        <div class="col-md-offset-2">
            <button type="button" class="btn btn-primary" id="createComment">Comment</button>
            </div>
</p>
</div>
<div id="commentsection">
    @Html.Action("Index", "comments1", Model.id)
</div>
@section Scripts {
    <script>
    $("#createComment").on('click', function () {
        var model = { 'id': Id, 'comments': comments };
        var comments = $('#txtComments').val();
        var Id = $('#hiddenIdField').val();


        $.ajax({
            //your params as it is
            url: '/comments1/SaveComments',
            data: { 'id': Id, 'commenty': comments },
              type: 'post'
        }).done(function (response) {
            //window.location = redirectURl //for redirecting to article details page
            //if you are passing id as parameter to the redirected page then you can do something like this.
          // window.location = response.redirectUrl + '/' + response.Id;
            // window.location.href = 'Url.Action("details", "articles", new { id = "id1" })';

           $.ajax({
               url: '/comments1/Index?Id=' + response.Id,
               type:'GET'
           }).done(function(responsecomment) {
               $('#commentsection').html(responsecomment);
           }).fail(function(err) {
               alert("Error Occured : " + err);
           });
        }).fail(function (error) {

        });

        });
    </script>
}